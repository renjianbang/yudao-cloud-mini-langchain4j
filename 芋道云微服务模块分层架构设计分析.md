# èŠ‹é“äº‘å¾®æœåŠ¡æ¨¡å—åˆ†å±‚æ¶æ„è®¾è®¡åˆ†æ

> **æ–‡æ¡£è¯´æ˜**ï¼šæœ¬æ–‡æ¡£æ·±å…¥åˆ†æèŠ‹é“äº‘é¡¹ç›®ä¸­ç‹¬ç‰¹çš„API/Serveråˆ†ç¦»æ¶æ„è®¾è®¡ï¼Œå¸®åŠ©å¼€å‘è€…ç†è§£ç°ä»£å¾®æœåŠ¡æ¶æ„çš„æœ€ä½³å®è·µã€‚

## ğŸ“‹ ç›®å½•

- [1. é¡¹ç›®æ¦‚è§ˆ](#1-é¡¹ç›®æ¦‚è§ˆ)
  - [1.1 é¡¹ç›®èƒŒæ™¯](#11-é¡¹ç›®èƒŒæ™¯)
  - [1.2 æŠ€æœ¯æ ˆ](#12-æŠ€æœ¯æ ˆ)
  - [1.3 æ¨¡å—åˆ’åˆ†](#13-æ¨¡å—åˆ’åˆ†)
- [2. æ¶æ„è®¾è®¡åŸç†](#2-æ¶æ„è®¾è®¡åŸç†)
  - [2.1 API/Serveråˆ†ç¦»çš„æ ¸å¿ƒä¼˜åŠ¿](#21-apiserveråˆ†ç¦»çš„æ ¸å¿ƒä¼˜åŠ¿)
  - [2.2 æ¶æ„è®¾è®¡å›¾](#22-æ¶æ„è®¾è®¡å›¾)
- [3. èŒè´£åˆ’åˆ†è¯´æ˜](#3-èŒè´£åˆ’åˆ†è¯´æ˜)
  - [3.1 APIæ¨¡å—èŒè´£](#31-apiæ¨¡å—èŒè´£)
  - [3.2 Serveræ¨¡å—èŒè´£](#32-serveræ¨¡å—èŒè´£)
- [4. ä¾èµ–å…³ç³»åˆ†æ](#4-ä¾èµ–å…³ç³»åˆ†æ)
  - [4.1 æ¨¡å—ä¾èµ–å±‚æ¬¡](#41-æ¨¡å—ä¾èµ–å±‚æ¬¡)
  - [4.2 ä¾èµ–å…³ç³»å›¾](#42-ä¾èµ–å…³ç³»å›¾)
  - [4.3 ä¾èµ–å…³ç³»ç‰¹ç‚¹](#43-ä¾èµ–å…³ç³»ç‰¹ç‚¹)
- [5. ä»£ç ç»„ç»‡ç»“æ„](#5-ä»£ç ç»„ç»‡ç»“æ„)
  - [5.1 APIæ¨¡å—ä»£ç ç»„ç»‡](#51-apiæ¨¡å—ä»£ç ç»„ç»‡)
  - [5.2 Serveræ¨¡å—ä»£ç ç»„ç»‡](#52-serveræ¨¡å—ä»£ç ç»„ç»‡)
- [6. å®é™…åº”ç”¨åœºæ™¯](#6-å®é™…åº”ç”¨åœºæ™¯)
  - [6.1 å¾®æœåŠ¡é—´è°ƒç”¨åœºæ™¯](#61-å¾®æœåŠ¡é—´è°ƒç”¨åœºæ™¯)
  - [6.2 æœåŠ¡æ³¨å†Œä¸å‘ç°](#62-æœåŠ¡æ³¨å†Œä¸å‘ç°)
  - [6.3 ç½‘å…³è·¯ç”±é…ç½®](#63-ç½‘å…³è·¯ç”±é…ç½®)
  - [6.4 å¾®æœåŠ¡è°ƒç”¨æµç¨‹](#64-å¾®æœåŠ¡è°ƒç”¨æµç¨‹)
  - [6.5 æ•°æ®ä¼ è¾“å¯¹è±¡è®¾è®¡](#65-æ•°æ®ä¼ è¾“å¯¹è±¡è®¾è®¡)
  - [6.6 é”™è¯¯å¤„ç†å’Œå®¹é”™æœºåˆ¶](#66-é”™è¯¯å¤„ç†å’Œå®¹é”™æœºåˆ¶)
- [7. æœ€ä½³å®è·µæ€»ç»“](#7-æœ€ä½³å®è·µæ€»ç»“)
  - [7.1 æ¥å£è®¾è®¡æœ€ä½³å®è·µ](#71-æ¥å£è®¾è®¡æœ€ä½³å®è·µ)
  - [7.2 å®ç°å±‚æœ€ä½³å®è·µ](#72-å®ç°å±‚æœ€ä½³å®è·µ)
  - [7.3 é…ç½®ç®¡ç†æœ€ä½³å®è·µ](#73-é…ç½®ç®¡ç†æœ€ä½³å®è·µ)
- [8. è®¾è®¡æ¨¡å¼åˆ†æ](#8-è®¾è®¡æ¨¡å¼åˆ†æ)
- [9. æ€»ç»“](#9-æ€»ç»“)
  - [9.1 æ¶æ„ä¼˜åŠ¿](#91-æ¶æ„ä¼˜åŠ¿)
  - [9.2 é€‚ç”¨åœºæ™¯](#92-é€‚ç”¨åœºæ™¯)
  - [9.3 æŠ€æœ¯è¦ç‚¹æ€»ç»“](#93-æŠ€æœ¯è¦ç‚¹æ€»ç»“)
  - [9.4 å­¦ä¹ å»ºè®®](#94-å­¦ä¹ å»ºè®®)
  - [9.5 æ‰©å±•æ€è€ƒ](#95-æ‰©å±•æ€è€ƒ)

## 1. é¡¹ç›®æ¦‚è§ˆ

### 1.1 é¡¹ç›®èƒŒæ™¯

èŠ‹é“äº‘ï¼ˆyudao-cloud-miniï¼‰æ˜¯èŠ‹é“æºç å›¢é˜Ÿå¼€æºçš„ä¼ä¸šçº§å¿«é€Ÿå¼€å‘å¹³å°çš„**ç²¾ç®€ç‰ˆæœ¬**ï¼ŒåŸºäº **JDK 17 + Spring Boot 3.4.5 + Spring Cloud 2024** æ„å»ºã€‚é¡¹ç›®é‡‡ç”¨äº†ç‹¬ç‰¹çš„ **API/Server åˆ†ç¦»æ¶æ„**ï¼Œæ˜¯ç°ä»£å¾®æœåŠ¡æ¶æ„è®¾è®¡çš„å…¸å‹ä»£è¡¨ã€‚

**é¡¹ç›®ç‰¹ç‚¹ï¼š**
- ğŸ”¥ **å®Œå…¨å¼€æº**ï¼šMITåè®®ï¼Œä¸ªäººä¸ä¼ä¸šå¯100%å…è´¹ä½¿ç”¨
- ğŸš€ **æŠ€æœ¯å…ˆè¿›**ï¼šåŸºäºæœ€æ–°çš„Spring Boot 3.xå’ŒSpring Cloud 2024
- ğŸ’¡ **æ¶æ„æ¸…æ™°**ï¼šé‡‡ç”¨DDDé¢†åŸŸé©±åŠ¨è®¾è®¡å’Œå¾®æœåŠ¡æœ€ä½³å®è·µ
- ğŸ›¡ï¸ **åŠŸèƒ½å®Œæ•´**ï¼šåŒ…å«ç”¨æˆ·ç®¡ç†ã€æƒé™æ§åˆ¶ã€å¤šç§Ÿæˆ·ã€å·¥ä½œæµç­‰ä¼ä¸šçº§åŠŸèƒ½

### 1.2 æŠ€æœ¯æ ˆ

#### æ ¸å¿ƒæ¡†æ¶
| æŠ€æœ¯ | ç‰ˆæœ¬ | è¯´æ˜ |
|------|------|------|
| Spring Boot | 3.4.5 | åŸºç¡€æ¡†æ¶ |
| Spring Cloud | 2024.0.1 | å¾®æœåŠ¡æ¡†æ¶ |
| Spring Cloud Alibaba | 2023.0.3.2 | é˜¿é‡Œäº‘å¾®æœåŠ¡ç»„ä»¶ |
| Spring Security | 6.3.1 | å®‰å…¨è®¤è¯æ¡†æ¶ |

#### æ•°æ®å­˜å‚¨
| æŠ€æœ¯ | ç‰ˆæœ¬ | è¯´æ˜ |
|------|------|------|
| MyBatis Plus | 3.5.12 | ORMæ¡†æ¶ |
| MySQL | 5.7/8.0+ | å…³ç³»å‹æ•°æ®åº“ |
| Redis | 5.0/6.0 | ç¼“å­˜æ•°æ®åº“ |
| Redisson | 3.41.0 | Rediså®¢æˆ·ç«¯ |

#### å¾®æœåŠ¡ç»„ä»¶
| æŠ€æœ¯ | ç‰ˆæœ¬ | è¯´æ˜ |
|------|------|------|
| Nacos | 2.3.2 | æ³¨å†Œä¸­å¿ƒ&é…ç½®ä¸­å¿ƒ |
| Gateway | 4.1.0 | æœåŠ¡ç½‘å…³ |
| Sentinel | 1.8.6 | æœåŠ¡ä¿éšœ |
| Seata | 1.6.1 | åˆ†å¸ƒå¼äº‹åŠ¡ |

### 1.3 æ¨¡å—åˆ’åˆ†

æ¯ä¸ªä¸šåŠ¡æ¨¡å—éƒ½è¢«æ‹†åˆ†ä¸ºä¸¤ä¸ªå­æ¨¡å—ï¼š
- **APIæ¨¡å—**ï¼šå®šä¹‰æœåŠ¡æ¥å£å¥‘çº¦å’Œæ•°æ®ä¼ è¾“å¯¹è±¡
- **Serveræ¨¡å—**ï¼šå®ç°å…·ä½“çš„ä¸šåŠ¡é€»è¾‘å’Œæ•°æ®è®¿é—®

#### ä¸»è¦ä¸šåŠ¡æ¨¡å—

| æ¨¡å— | APIæ¨¡å— | Serveræ¨¡å— | åŠŸèƒ½æè¿° |
|------|---------|------------|----------|
| system | yudao-module-system-api | yudao-module-system-server | ç”¨æˆ·ç®¡ç†ã€è§’è‰²æƒé™ã€èœå•ç®¡ç†ã€éƒ¨é—¨ç®¡ç†ç­‰ |
| infra | yudao-module-infra-api | yudao-module-infra-server | ä»£ç ç”Ÿæˆã€æ–‡ä»¶ç®¡ç†ã€å®šæ—¶ä»»åŠ¡ã€APIæ—¥å¿—ç­‰ |
| bpm | yudao-module-bpm-api | yudao-module-bpm-server | å·¥ä½œæµç¨‹ç®¡ç†ã€æµç¨‹è®¾è®¡å™¨ç­‰ |
| pay | yudao-module-pay-api | yudao-module-pay-server | æ”¯ä»˜ç³»ç»Ÿã€é€€æ¬¾ç®¡ç†ç­‰ |
| mall | yudao-module-mall-api | yudao-module-mall-server | å•†åŸç³»ç»Ÿã€å•†å“ç®¡ç†ç­‰ |

## 2. æ¶æ„è®¾è®¡åŸç†

### 2.1 API/Server åˆ†ç¦»çš„æ ¸å¿ƒä¼˜åŠ¿

#### ğŸ”¹ æ¥å£ä¸å®ç°åˆ†ç¦»
- **å¥‘çº¦ä¼˜å…ˆ**ï¼šAPIæ¨¡å—å®šä¹‰æœåŠ¡å¥‘çº¦ï¼Œç¡®ä¿æ¥å£ç¨³å®šæ€§
- **å®ç°éšè—**ï¼šServeræ¨¡å—éšè—å…·ä½“å®ç°ç»†èŠ‚ï¼Œé™ä½è€¦åˆåº¦
- **ç‰ˆæœ¬ç®¡ç†**ï¼šAPIç‰ˆæœ¬ç‹¬ç«‹æ¼”è¿›ï¼Œå‘åå…¼å®¹æ›´å®¹æ˜“

#### ğŸ”¹ å¾®æœåŠ¡æ¶æ„æ”¯æŒ
- **æœåŠ¡å‘ç°**ï¼šé€šè¿‡ `@FeignClient` å®ç°æœåŠ¡é—´è°ƒç”¨
- **è´Ÿè½½å‡è¡¡**ï¼šæ”¯æŒå¤šå®ä¾‹éƒ¨ç½²å’Œè´Ÿè½½å‡è¡¡
- **æ•…éšœéš”ç¦»**ï¼šå•ä¸ªæœåŠ¡æ•…éšœä¸å½±å“æ•´ä½“ç³»ç»Ÿ

#### ğŸ”¹ å¼€å‘æ•ˆç‡æå‡
- **å¹¶è¡Œå¼€å‘**ï¼šAPIå®šä¹‰åï¼Œå‰ç«¯å’Œåç«¯å¯å¹¶è¡Œå¼€å‘
- **æ¥å£å¤ç”¨**ï¼šAPIæ¨¡å—å¯è¢«å¤šä¸ªæœåŠ¡å¤ç”¨
- **æµ‹è¯•å‹å¥½**ï¼šæ¥å£å’Œå®ç°åˆ†ç¦»ï¼Œä¾¿äºå•å…ƒæµ‹è¯•

### 2.2 æ¶æ„è®¾è®¡å›¾

```mermaid
graph TB
    subgraph "å¾®æœåŠ¡æ¨¡å—åˆ†å±‚æ¶æ„"
        subgraph "yudao-module-system"
            subgraph "system-api"
                A1[AdminUserApiæ¥å£]
                A2[DeptApiæ¥å£]
                A3[PermissionApiæ¥å£]
                A4[AdminUserRespDTO]
                A5[DeptRespDTO]
                A6[SmsCodeSendReqDTO]
                A7[ApiConstantså¸¸é‡]
                A8[ErrorCodeConstants]
            end
            
            subgraph "system-server"
                B1[AdminUserApiImplå®ç°]
                B2[DeptApiImplå®ç°]
                B3[AdminUserController]
                B4[AdminUserService]
                B5[AdminUserMapper]
                B6[AdminUserDOå®ä½“]
                B7[SystemServerApplication]
            end
        end
        
        subgraph "yudao-module-infra"
            subgraph "infra-api"
                C1[FileApiæ¥å£]
                C2[ConfigApiæ¥å£]
                C3[WebSocketSenderApi]
                C4[FileRespDTO]
            end
            
            subgraph "infra-server"
                D1[FileApiImplå®ç°]
                D2[FileController]
                D3[FileService]
                D4[FileMapper]
            end
        end
        
        subgraph "å…¶ä»–æœåŠ¡æ¨¡å—"
            E1[yudao-serverä¸»æœåŠ¡]
            E2[yudao-gatewayç½‘å…³]
            E3[ç¬¬ä¸‰æ–¹æœåŠ¡]
        end
    end
    
    %% ä¾èµ–å…³ç³»
    B1 --> A1
    B2 --> A2
    B3 --> B4
    B4 --> B5
    B5 --> B6
    
    D1 --> C1
    D2 --> D3
    
    %% è·¨æ¨¡å—è°ƒç”¨
    E1 --> A1
    E1 --> C1
    E2 --> A1
    E3 --> A1
```

## 3. èŒè´£åˆ’åˆ†è¯´æ˜

### 3.1 API æ¨¡å—èŒè´£

APIæ¨¡å—ä½œä¸º**æœåŠ¡å¥‘çº¦å±‚**ï¼Œä¸»è¦è´Ÿè´£ï¼š

#### ğŸ”¸ Feignæ¥å£å®šä¹‰
```java
@FeignClient(name = ApiConstants.NAME) // Feignå®¢æˆ·ç«¯å£°æ˜
@Tag(name = "RPC æœåŠ¡ - ç®¡ç†å‘˜ç”¨æˆ·")
@AutoTrans(namespace = PREFIX, fields = {"nickname"})
public interface AdminUserApi extends AutoTransable<AdminUserRespDTO> {
    
    String PREFIX = ApiConstants.PREFIX + "/user";
    
    @GetMapping(PREFIX + "/get")
    @Operation(summary = "é€šè¿‡ç”¨æˆ· ID æŸ¥è¯¢ç”¨æˆ·")
    @Parameter(name = "id", description = "ç”¨æˆ·ç¼–å·", example = "1", required = true)
    CommonResult<AdminUserRespDTO> getUser(@RequestParam("id") Long id);
    
    @GetMapping(PREFIX + "/list")
    @Operation(summary = "é€šè¿‡ç”¨æˆ· ID æŸ¥è¯¢ç”¨æˆ·ä»¬")
    CommonResult<List<AdminUserRespDTO>> getUserList(@RequestParam("ids") Collection<Long> ids);
}
```

#### ğŸ”¸ DTOæ•°æ®ä¼ è¾“å¯¹è±¡
```java
@Schema(description = "RPC æœåŠ¡ - Admin ç”¨æˆ· Response DTO")
@Data
public class AdminUserRespDTO implements VO {
    
    @Schema(description = "ç”¨æˆ· ID", requiredMode = Schema.RequiredMode.REQUIRED, example = "1024")
    private Long id;
    
    @Schema(description = "ç”¨æˆ·æ˜µç§°", requiredMode = Schema.RequiredMode.REQUIRED, example = "å°ç‹")
    private String nickname;
    
    @Schema(description = "å¸å·çŠ¶æ€", requiredMode = Schema.RequiredMode.REQUIRED, example = "1")
    private Integer status; // å‚è§ CommonStatusEnum æšä¸¾
}
```

#### ğŸ”¸ ä¸šåŠ¡å¸¸é‡å’Œæšä¸¾
```java
public class ApiConstants {
    /**
     * æœåŠ¡å - éœ€è¦ä¿è¯å’Œ spring.application.name ä¿æŒä¸€è‡´
     */
    public static final String NAME = "system-server";
    
    public static final String PREFIX = RpcConstants.RPC_API_PREFIX +  "/system";
    
    public static final String VERSION = "1.0.0";
}
```

#### ğŸ”¸ ä¾¿æ·æ–¹æ³•æä¾›
```java
// APIæ¥å£ä¸­çš„é»˜è®¤æ–¹æ³•ï¼Œç®€åŒ–è°ƒç”¨
default Map<Long, AdminUserRespDTO> getUserMap(Collection<Long> ids) {
    List<AdminUserRespDTO> users = getUserList(ids).getCheckedData();
    return CollectionUtils.convertMap(users, AdminUserRespDTO::getId);
}

default void validateUser(Long id) {
    validateUserList(Collections.singleton(id));
}
```

#### ğŸ”¸ APIæ¨¡å—å®Œæ•´ç¤ºä¾‹
```java
// å®Œæ•´çš„APIæ¥å£å®šä¹‰ç¤ºä¾‹
@FeignClient(name = ApiConstants.NAME)
@Tag(name = "RPC æœåŠ¡ - éƒ¨é—¨")
public interface DeptApi {

    String PREFIX = ApiConstants.PREFIX + "/dept";

    @GetMapping(PREFIX + "/get")
    @Operation(summary = "è·å¾—éƒ¨é—¨ä¿¡æ¯")
    @Parameter(name = "id", description = "éƒ¨é—¨ç¼–å·", example = "1024", required = true)
    CommonResult<DeptRespDTO> getDept(@RequestParam("id") Long id);

    @GetMapping(PREFIX + "/list")
    @Operation(summary = "è·å¾—éƒ¨é—¨ä¿¡æ¯æ•°ç»„")
    @Parameter(name = "ids", description = "éƒ¨é—¨ç¼–å·æ•°ç»„", example = "1,2", required = true)
    CommonResult<List<DeptRespDTO>> getDeptList(@RequestParam("ids") Collection<Long> ids);

    @GetMapping(PREFIX + "/valid")
    @Operation(summary = "æ ¡éªŒéƒ¨é—¨æ˜¯å¦åˆæ³•")
    @Parameter(name = "ids", description = "éƒ¨é—¨ç¼–å·æ•°ç»„", example = "1,2", required = true)
    CommonResult<Boolean> validateDeptList(@RequestParam("ids") Collection<Long> ids);
}
```

### 3.2 Server æ¨¡å—èŒè´£

Serveræ¨¡å—ä½œä¸º**æœåŠ¡å®ç°å±‚**ï¼Œä¸»è¦è´Ÿè´£ï¼š

#### ğŸ”¸ APIæ¥å£å®ç°
```java
@RestController // æä¾› RESTful API æ¥å£ï¼Œç»™ Feign è°ƒç”¨
@Validated
public class AdminUserApiImpl implements AdminUserApi {
    
    @Resource
    private AdminUserService userService;
    @Resource
    private DeptService deptService;
    
    @Override
    public CommonResult<AdminUserRespDTO> getUser(Long id) {
        AdminUserDO user = userService.getUser(id);
        return success(BeanUtils.toBean(user, AdminUserRespDTO.class));
    }
    
    @Override
    public CommonResult<List<AdminUserRespDTO>> getUserList(Collection<Long> ids) {
        return DataPermissionUtils.executeIgnore(() -> { // ç¦ç”¨æ•°æ®æƒé™
            List<AdminUserDO> users = userService.getUserList(ids);
            return success(BeanUtils.toBean(users, AdminUserRespDTO.class));
        });
    }
}
```

#### ğŸ”¸ HTTPæ§åˆ¶å™¨å±‚
```java
@Tag(name = "ç®¡ç†åå° - ç”¨æˆ·")
@RestController
@RequestMapping("/system/user")
@Validated
public class UserController {
    
    @Resource
    private AdminUserService userService;
    
    @PostMapping("/create")
    @Operation(summary = "æ–°å¢ç”¨æˆ·")
    @PreAuthorize("@ss.hasPermission('system:user:create')")
    public CommonResult<Long> createUser(@Valid @RequestBody UserSaveReqVO createReqVO) {
        Long userId = userService.createUser(createReqVO);
        return success(userId);
    }
}
```

#### ğŸ”¸ ä¸šåŠ¡æœåŠ¡å±‚
```java
@Service
@Validated
@Slf4j
public class AdminUserServiceImpl implements AdminUserService {
    
    @Resource
    private AdminUserMapper userMapper;
    
    @Override
    @Transactional(rollbackFor = Exception.class)
    public Long createUser(UserSaveReqVO createReqVO) {
        // 1. æ ¡éªŒæ­£ç¡®æ€§
        validateUserForCreateOrUpdate(null, createReqVO.getUsername(),
                createReqVO.getMobile(), createReqVO.getEmail(), 
                createReqVO.getDeptId(), createReqVO.getPostIds());
        
        // 2. æ’å…¥ç”¨æˆ·
        AdminUserDO user = BeanUtils.toBean(createReqVO, AdminUserDO.class);
        user.setStatus(CommonStatusEnum.ENABLE.getStatus());
        user.setPassword(encodePassword(createReqVO.getPassword()));
        userMapper.insert(user);
        
        return user.getId();
    }
}
```

#### ğŸ”¸ æ•°æ®è®¿é—®å±‚
```java
@Mapper
public interface AdminUserMapper extends BaseMapperX<AdminUserDO> {

    default AdminUserDO selectByUsername(String username) {
        return selectOne(AdminUserDO::getUsername, username);
    }

    default AdminUserDO selectByMobile(String mobile) {
        return selectOne(AdminUserDO::getMobile, mobile);
    }

    default PageResult<AdminUserDO> selectPage(UserPageReqVO reqVO,
                                               Collection<Long> deptIds) {
        return selectPage(reqVO, new LambdaQueryWrapperX<AdminUserDO>()
                .likeIfPresent(AdminUserDO::getUsername, reqVO.getUsername())
                .likeIfPresent(AdminUserDO::getMobile, reqVO.getMobile())
                .eqIfPresent(AdminUserDO::getStatus, reqVO.getStatus())
                .inIfPresent(AdminUserDO::getDeptId, deptIds)
                .orderByDesc(AdminUserDO::getId));
    }
}
```

#### ğŸ”¸ æ•°æ®å®ä½“å¯¹è±¡
```java
@TableName("system_users")
@Data
@EqualsAndHashCode(callSuper = true)
@Builder
@NoArgsConstructor
@AllArgsConstructor
public class AdminUserDO extends BaseDO {

    /**
     * ç”¨æˆ·ID
     */
    @TableId
    private Long id;

    /**
     * ç”¨æˆ·è´¦å·
     */
    private String username;

    /**
     * åŠ å¯†åçš„å¯†ç 
     */
    private String password;

    /**
     * ç”¨æˆ·æ˜µç§°
     */
    private String nickname;

    /**
     * ç”¨æˆ·é‚®ç®±
     */
    private String email;

    /**
     * æ‰‹æœºå·ç 
     */
    private String mobile;

    /**
     * ç”¨æˆ·æ€§åˆ«
     */
    private Integer sex;

    /**
     * ç”¨æˆ·å¤´åƒ
     */
    private String avatar;

    /**
     * å¸å·çŠ¶æ€ï¼ˆ0æ­£å¸¸ 1åœç”¨ï¼‰
     */
    private Integer status;

    /**
     * éƒ¨é—¨ID
     */
    private Long deptId;

    /**
     * å²—ä½ç¼–å·æ•°ç»„
     */
    @TableField(typeHandler = JsonLongSetTypeHandler.class)
    private Set<Long> postIds;
}
```

## 4. ä¾èµ–å…³ç³»åˆ†æ

### 4.1 æ¨¡å—ä¾èµ–å±‚æ¬¡

#### APIæ¨¡å—ä¾èµ–ï¼ˆè½»é‡çº§ï¼‰
```xml
<!-- yudao-module-system-api/pom.xml -->
<dependencies>
    <!-- åªä¾èµ–åŸºç¡€æ¡†æ¶ -->
    <dependency>
        <groupId>cn.iocoder.cloud</groupId>
        <artifactId>yudao-common</artifactId>
    </dependency>
    
    <!-- æ¥å£æ–‡æ¡£æ”¯æŒ -->
    <dependency>
        <groupId>org.springdoc</groupId>
        <artifactId>springdoc-openapi-starter-webmvc-api</artifactId>
        <scope>provided</scope>
    </dependency>
    
    <!-- RPC è¿œç¨‹è°ƒç”¨ -->
    <dependency>
        <groupId>org.springframework.cloud</groupId>
        <artifactId>spring-cloud-starter-openfeign</artifactId>
        <optional>true</optional>
    </dependency>
</dependencies>
```

#### Serveræ¨¡å—ä¾èµ–ï¼ˆå®Œæ•´åŠŸèƒ½ï¼‰
```xml
<!-- yudao-module-system-server/pom.xml -->
<dependencies>
    <!-- ä¾èµ–è‡ªå·±çš„APIæ¨¡å— -->
    <dependency>
        <groupId>cn.iocoder.cloud</groupId>
        <artifactId>yudao-module-system-api</artifactId>
        <version>${revision}</version>
    </dependency>
    
    <!-- ä¾èµ–å…¶ä»–æ¨¡å—çš„API -->
    <dependency>
        <groupId>cn.iocoder.cloud</groupId>
        <artifactId>yudao-module-infra-api</artifactId>
        <version>${revision}</version>
    </dependency>
    
    <!-- ä¸šåŠ¡ç»„ä»¶ -->
    <dependency>
        <groupId>cn.iocoder.cloud</groupId>
        <artifactId>yudao-spring-boot-starter-biz-tenant</artifactId>
    </dependency>
    
    <!-- æ•°æ®åº“ç›¸å…³ -->
    <dependency>
        <groupId>cn.iocoder.cloud</groupId>
        <artifactId>yudao-spring-boot-starter-mybatis</artifactId>
    </dependency>
    
    <!-- å®‰å…¨è®¤è¯ -->
    <dependency>
        <groupId>cn.iocoder.cloud</groupId>
        <artifactId>yudao-spring-boot-starter-security</artifactId>
    </dependency>
</dependencies>
```

### 4.2 ä¾èµ–å…³ç³»å›¾

```mermaid
graph TD
    subgraph "ä¸»æœåŠ¡"
        MS[yudao-serverä¸»æœåŠ¡]
    end
    
    subgraph "Systemæ¨¡å—"
        SA[system-api]
        SS[system-server]
    end
    
    subgraph "Infraæ¨¡å—"
        IA[infra-api]
        IS[infra-server]
    end
    
    subgraph "Frameworkæ¡†æ¶"
        FC[yudao-common]
        FW[yudao-frameworkå„ç§starter]
    end
    
    %% ä¾èµ–å…³ç³»
    MS --> SA
    MS --> IA
    
    SS --> SA
    SS --> IA
    SS --> FC
    SS --> FW
    
    IS --> IA
    IS --> SA
    IS --> FC
    IS --> FW
    
    SA --> FC
    IA --> FC
    
    %% æ ·å¼
    classDef api fill:#e3f2fd
    classDef server fill:#fce4ec
    classDef main fill:#e8f5e8
    classDef framework fill:#fff3e0
    
    class SA,IA api
    class SS,IS server
    class MS main
    class FC,FW framework
```

### 4.3 ä¾èµ–å…³ç³»ç‰¹ç‚¹

- âœ… **Serverä¾èµ–API**ï¼šServeræ¨¡å—ä¾èµ–è‡ªå·±çš„APIæ¨¡å—
- âœ… **è·¨æ¨¡å—APIä¾èµ–**ï¼šåªä¾èµ–å…¶ä»–æ¨¡å—çš„APIï¼Œä¸ä¾èµ–Server
- âœ… **å•å‘ä¾èµ–**ï¼šé¿å…å¾ªç¯ä¾èµ–ï¼Œä¿æŒæ¶æ„æ¸…æ™°
- âœ… **è½»é‡çº§API**ï¼šAPIæ¨¡å—ä¾èµ–æœ€å°åŒ–ï¼Œä¾¿äºåˆ†å‘

## 5. ä»£ç ç»„ç»‡ç»“æ„

### 5.1 APIæ¨¡å—ä»£ç ç»„ç»‡

```
yudao-module-system-api/
â”œâ”€â”€ src/main/java/cn/iocoder/yudao/module/system/
â”‚   â”œâ”€â”€ api/                    # Feignæ¥å£å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ user/
â”‚   â”‚   â”‚   â”œâ”€â”€ AdminUserApi.java      # ç”¨æˆ·APIæ¥å£
â”‚   â”‚   â”‚   â””â”€â”€ dto/
â”‚   â”‚   â”‚       â”œâ”€â”€ AdminUserRespDTO.java  # å“åº”DTO
â”‚   â”‚   â”‚       â””â”€â”€ AdminUserReqDTO.java   # è¯·æ±‚DTO
â”‚   â”‚   â”œâ”€â”€ dept/
â”‚   â”‚   â”‚   â”œâ”€â”€ DeptApi.java           # éƒ¨é—¨APIæ¥å£
â”‚   â”‚   â”‚   â””â”€â”€ dto/
â”‚   â”‚   â”‚       â””â”€â”€ DeptRespDTO.java
â”‚   â”‚   â”œâ”€â”€ permission/
â”‚   â”‚   â”‚   â”œâ”€â”€ PermissionApi.java     # æƒé™APIæ¥å£
â”‚   â”‚   â”‚   â””â”€â”€ dto/
â”‚   â”‚   â””â”€â”€ sms/
â”‚   â”‚       â”œâ”€â”€ SmsCodeApi.java        # çŸ­ä¿¡APIæ¥å£
â”‚   â”‚       â””â”€â”€ dto/
â”‚   â””â”€â”€ enums/                  # æšä¸¾å’Œå¸¸é‡
â”‚       â”œâ”€â”€ ApiConstants.java          # APIå¸¸é‡
â”‚       â”œâ”€â”€ ErrorCodeConstants.java    # é”™è¯¯ç 
â”‚       â”œâ”€â”€ DictTypeConstants.java     # å­—å…¸ç±»å‹
â”‚       â””â”€â”€ LogRecordConstants.java    # æ—¥å¿—è®°å½•å¸¸é‡
â””â”€â”€ pom.xml                     # è½»é‡çº§ä¾èµ–é…ç½®
```

### 5.2 Serveræ¨¡å—ä»£ç ç»„ç»‡

```
yudao-module-system-server/
â”œâ”€â”€ src/main/java/cn/iocoder/yudao/module/system/
â”‚   â”œâ”€â”€ SystemServerApplication.java   # å¯åŠ¨ç±»
â”‚   â”œâ”€â”€ api/                    # APIæ¥å£å®ç°
â”‚   â”‚   â”œâ”€â”€ user/
â”‚   â”‚   â”‚   â””â”€â”€ AdminUserApiImpl.java  # APIå®ç°ç±»
â”‚   â”‚   â”œâ”€â”€ dept/
â”‚   â”‚   â”‚   â””â”€â”€ DeptApiImpl.java
â”‚   â”‚   â””â”€â”€ permission/
â”‚   â”œâ”€â”€ controller/             # HTTPæ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ admin/              # ç®¡ç†ç«¯æ¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ user/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ UserController.java
â”‚   â”‚   â”‚   â””â”€â”€ dept/
â”‚   â”‚   â””â”€â”€ app/                # ç”¨æˆ·ç«¯æ¥å£
â”‚   â”œâ”€â”€ service/                # ä¸šåŠ¡æœåŠ¡å±‚
â”‚   â”‚   â”œâ”€â”€ user/
â”‚   â”‚   â”‚   â”œâ”€â”€ AdminUserService.java      # æœåŠ¡æ¥å£
â”‚   â”‚   â”‚   â””â”€â”€ AdminUserServiceImpl.java  # æœåŠ¡å®ç°
â”‚   â”‚   â”œâ”€â”€ dept/
â”‚   â”‚   â”‚   â”œâ”€â”€ DeptService.java
â”‚   â”‚   â”‚   â””â”€â”€ DeptServiceImpl.java
â”‚   â”‚   â””â”€â”€ permission/
â”‚   â”œâ”€â”€ dal/                    # æ•°æ®è®¿é—®å±‚
â”‚   â”‚   â”œâ”€â”€ dataobject/         # æ•°æ®å¯¹è±¡
â”‚   â”‚   â”‚   â”œâ”€â”€ user/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ AdminUserDO.java   # æ•°æ®å®ä½“
â”‚   â”‚   â”‚   â””â”€â”€ dept/
â”‚   â”‚   â”‚       â””â”€â”€ DeptDO.java
â”‚   â”‚   â”œâ”€â”€ mysql/              # MySQLæ˜ å°„å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ user/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ AdminUserMapper.java
â”‚   â”‚   â”‚   â””â”€â”€ dept/
â”‚   â”‚   â””â”€â”€ redis/              # Redisæ“ä½œ
â”‚   â”œâ”€â”€ convert/                # å¯¹è±¡è½¬æ¢å™¨
â”‚   â”‚   â”œâ”€â”€ user/
â”‚   â”‚   â”‚   â””â”€â”€ UserConvert.java
â”‚   â”‚   â””â”€â”€ auth/
â”‚   â”œâ”€â”€ framework/              # æ¡†æ¶é…ç½®
â”‚   â”‚   â”œâ”€â”€ security/           # å®‰å…¨é…ç½®
â”‚   â”‚   â”œâ”€â”€ datapermission/     # æ•°æ®æƒé™
â”‚   â”‚   â””â”€â”€ operatelog/         # æ“ä½œæ—¥å¿—
â”‚   â”œâ”€â”€ job/                    # å®šæ—¶ä»»åŠ¡
â”‚   â””â”€â”€ mq/                     # æ¶ˆæ¯é˜Ÿåˆ—
â”‚       â”œâ”€â”€ producer/           # æ¶ˆæ¯ç”Ÿäº§è€…
â”‚       â”œâ”€â”€ consumer/           # æ¶ˆæ¯æ¶ˆè´¹è€…
â”‚       â””â”€â”€ message/            # æ¶ˆæ¯å®šä¹‰
â”œâ”€â”€ src/main/resources/
â”‚   â”œâ”€â”€ application.yaml        # é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ mapper/                 # MyBatisæ˜ å°„æ–‡ä»¶
â””â”€â”€ pom.xml                     # å®Œæ•´ä¾èµ–é…ç½®
```

## 6. å®é™…åº”ç”¨åœºæ™¯

### 6.1 å¾®æœåŠ¡é—´è°ƒç”¨åœºæ™¯

#### åœºæ™¯1ï¼šç”¨æˆ·ä¿¡æ¯æŸ¥è¯¢
```java
// å…¶ä»–æœåŠ¡è°ƒç”¨systemæ¨¡å—çš„ç”¨æˆ·API
@Service
public class SomeBusinessService {
    
    @Resource
    private AdminUserApi adminUserApi; // æ³¨å…¥APIæ¥å£
    
    public void processUserData(Long userId) {
        // é€šè¿‡Feignè°ƒç”¨è¿œç¨‹æœåŠ¡
        AdminUserRespDTO user = adminUserApi.getUser(userId).getCheckedData();
        
        // æ‰¹é‡æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯
        List<Long> userIds = Arrays.asList(1L, 2L, 3L);
        Map<Long, AdminUserRespDTO> userMap = adminUserApi.getUserMap(userIds);
        
        // ä¸šåŠ¡é€»è¾‘å¤„ç†...
    }
}
```

#### åœºæ™¯2ï¼šæ–‡ä»¶ä¸Šä¼ æœåŠ¡
```java
// systemæ¨¡å—è°ƒç”¨infraæ¨¡å—çš„æ–‡ä»¶API
@Service
public class UserAvatarService {
    
    @Resource
    private FileApi fileApi; // æ³¨å…¥æ–‡ä»¶API
    
    public String uploadAvatar(Long userId, MultipartFile file) {
        // è°ƒç”¨æ–‡ä»¶æœåŠ¡ä¸Šä¼ å¤´åƒ
        String fileUrl = fileApi.createFile(file).getCheckedData();
        
        // æ›´æ–°ç”¨æˆ·å¤´åƒä¿¡æ¯
        userService.updateUserAvatar(userId, fileUrl);
        
        return fileUrl;
    }
}
```

### 6.2 æœåŠ¡æ³¨å†Œä¸å‘ç°

#### Feignå®¢æˆ·ç«¯é…ç½®
```java
// APIæ¨¡å—ä¸­çš„Feignå®¢æˆ·ç«¯å£°æ˜
@FeignClient(name = ApiConstants.NAME) // æœåŠ¡åï¼šsystem-server
public interface AdminUserApi {
    // æ¥å£å®šä¹‰...
}
```

#### æœåŠ¡æä¾›è€…é…ç½®
```yaml
# system-serverçš„application.yaml
spring:
  application:
    name: system-server  # ä¸ApiConstants.NAMEä¿æŒä¸€è‡´
  cloud:
    nacos:
      discovery:
        enabled: true
        server-addr: 127.0.0.1:8848
```

### 6.3 ç½‘å…³è·¯ç”±é…ç½®

```yaml
# yudao-gatewayçš„è·¯ç”±é…ç½®
spring:
  cloud:
    gateway:
      routes:
        # system-server æœåŠ¡è·¯ç”±
        - id: system-admin-api
          uri: grayLb://system-server  # è´Ÿè½½å‡è¡¡åˆ°system-server
          predicates:
            - Path=/admin-api/system/**
          filters:
            - RewritePath=/admin-api/system/v3/api-docs, /v3/api-docs

        # infra-server æœåŠ¡è·¯ç”±
        - id: infra-admin-api
          uri: grayLb://infra-server
          predicates:
            - Path=/admin-api/infra/**
```

### 6.4 å¾®æœåŠ¡è°ƒç”¨æµç¨‹

```mermaid
sequenceDiagram
    participant Client as å®¢æˆ·ç«¯
    participant Gateway as yudao-gateway
    participant MainServer as yudao-server
    participant SystemAPI as system-api
    participant SystemServer as system-server
    participant InfraAPI as infra-api
    participant InfraServer as infra-server

    Client->>Gateway: HTTPè¯·æ±‚
    Gateway->>MainServer: è·¯ç”±è½¬å‘

    Note over MainServer: ä¸šåŠ¡å¤„ç†éœ€è¦è°ƒç”¨å…¶ä»–æœåŠ¡

    MainServer->>SystemAPI: @Autowired AdminUserApi
    SystemAPI->>SystemServer: Feignè¿œç¨‹è°ƒç”¨
    SystemServer->>SystemServer: ä¸šåŠ¡é€»è¾‘å¤„ç†
    SystemServer-->>SystemAPI: è¿”å›ç»“æœ
    SystemAPI-->>MainServer: è¿”å›DTO

    MainServer->>InfraAPI: @Autowired FileApi
    InfraAPI->>InfraServer: Feignè¿œç¨‹è°ƒç”¨
    InfraServer->>InfraServer: æ–‡ä»¶å¤„ç†
    InfraServer-->>InfraAPI: è¿”å›ç»“æœ
    InfraAPI-->>MainServer: è¿”å›DTO

    MainServer-->>Gateway: å“åº”ç»“æœ
    Gateway-->>Client: HTTPå“åº”
```

### 6.5 æ•°æ®ä¼ è¾“å¯¹è±¡è®¾è®¡

#### è¯·æ±‚DTOè®¾è®¡
```java
@Schema(description = "ç®¡ç†åå° - ç”¨æˆ·åˆ›å»º/ä¿®æ”¹ Request VO")
@Data
public class UserSaveReqVO {

    @Schema(description = "ç”¨æˆ·ç¼–å·", example = "1")
    private Long id;

    @Schema(description = "ç”¨æˆ·è´¦å·", requiredMode = Schema.RequiredMode.REQUIRED, example = "yudao")
    @NotBlank(message = "ç”¨æˆ·è´¦å·ä¸èƒ½ä¸ºç©º")
    @Pattern(regexp = "^[a-zA-Z0-9]{4,30}$", message = "ç”¨æˆ·è´¦å·ç”± æ•°å­—ã€å­—æ¯ ç»„æˆ")
    @Size(min = 4, max = 30, message = "ç”¨æˆ·è´¦å·é•¿åº¦ä¸º 4-30 ä¸ªå­—ç¬¦")
    private String username;

    @Schema(description = "å¯†ç ", requiredMode = Schema.RequiredMode.REQUIRED, example = "123456")
    @Length(min = 4, max = 16, message = "å¯†ç é•¿åº¦ä¸º 4-16 ä½")
    private String password;
}
```

#### å“åº”DTOè®¾è®¡
```java
@Schema(description = "RPC æœåŠ¡ - Admin ç”¨æˆ· Response DTO")
@Data
public class AdminUserRespDTO implements VO {

    @Schema(description = "ç”¨æˆ· ID", requiredMode = Schema.RequiredMode.REQUIRED, example = "1024")
    private Long id;

    @Schema(description = "ç”¨æˆ·æ˜µç§°", requiredMode = Schema.RequiredMode.REQUIRED, example = "å°ç‹")
    private String nickname;

    @Schema(description = "å¸å·çŠ¶æ€", requiredMode = Schema.RequiredMode.REQUIRED, example = "1")
    private Integer status; // å‚è§ CommonStatusEnum æšä¸¾

    @Schema(description = "éƒ¨é—¨ç¼–å·", requiredMode = Schema.RequiredMode.REQUIRED, example = "1")
    private Long deptId;

    @Schema(description = "å²—ä½ç¼–å·æ•°ç»„", requiredMode = Schema.RequiredMode.REQUIRED, example = "[1, 3]")
    private Set<Long> postIds;
}

### 6.6 é”™è¯¯å¤„ç†å’Œå®¹é”™æœºåˆ¶

#### ç»Ÿä¸€å¼‚å¸¸å¤„ç†
```java
@RestController
@Validated
public class AdminUserApiImpl implements AdminUserApi {

    @Override
    public CommonResult<Boolean> validateUserList(Collection<Long> ids) {
        try {
            userService.validateUserList(ids);
            return success(true);
        } catch (ServiceException ex) {
            // ä¸šåŠ¡å¼‚å¸¸ç»Ÿä¸€å¤„ç†
            return CommonResult.error(ex.getCode(), ex.getMessage());
        }
    }
}
```

#### Feignå®¹é”™é…ç½®
```java
// å¯ä»¥é…ç½®Feignçš„fallbackæœºåˆ¶
@FeignClient(name = ApiConstants.NAME, fallbackFactory = AdminUserApiFallbackFactory.class)
public interface AdminUserApi {
    // æ¥å£å®šä¹‰...
}

@Component
public class AdminUserApiFallbackFactory implements FallbackFactory<AdminUserApi> {
    @Override
    public AdminUserApi create(Throwable cause) {
        return new AdminUserApi() {
            @Override
            public CommonResult<AdminUserRespDTO> getUser(Long id) {
                log.error("è°ƒç”¨ç”¨æˆ·æœåŠ¡å¤±è´¥", cause);
                return CommonResult.error(500, "ç”¨æˆ·æœåŠ¡æš‚æ—¶ä¸å¯ç”¨");
            }
        };
    }
}
```

## 7. æœ€ä½³å®è·µæ€»ç»“

### 7.1 æ¥å£è®¾è®¡æœ€ä½³å®è·µ

#### ğŸ”¹ ç»Ÿä¸€è¿”å›æ ¼å¼
```java
// æ‰€æœ‰APIéƒ½ä½¿ç”¨CommonResultåŒ…è£…è¿”å›ç»“æœ
public interface AdminUserApi {
    CommonResult<AdminUserRespDTO> getUser(@RequestParam("id") Long id);
    CommonResult<List<AdminUserRespDTO>> getUserList(@RequestParam("ids") Collection<Long> ids);
    CommonResult<Boolean> validateUserList(@RequestParam("ids") Collection<Long> ids);
}
```

#### ğŸ”¹ å‚æ•°æ ¡éªŒè§„èŒƒ
```java
@Schema(description = "RPC æœåŠ¡ - çŸ­ä¿¡éªŒè¯ç çš„å‘é€ Request DTO")
@Data
public class SmsCodeSendReqDTO {
    
    @Schema(description = "æ‰‹æœºå·", requiredMode = Schema.RequiredMode.REQUIRED)
    @Mobile
    @NotEmpty(message = "æ‰‹æœºå·ä¸èƒ½ä¸ºç©º")
    private String mobile;
    
    @Schema(description = "å‘é€åœºæ™¯", requiredMode = Schema.RequiredMode.REQUIRED)
    @NotNull(message = "å‘é€åœºæ™¯ä¸èƒ½ä¸ºç©º")
    @InEnum(SmsSceneEnum.class)
    private Integer scene;
}
```

#### ğŸ”¹ æ¥å£æ–‡æ¡£è§„èŒƒ
```java
@GetMapping(PREFIX + "/get")
@Operation(summary = "é€šè¿‡ç”¨æˆ· ID æŸ¥è¯¢ç”¨æˆ·")
@Parameter(name = "id", description = "ç”¨æˆ·ç¼–å·", example = "1", required = true)
CommonResult<AdminUserRespDTO> getUser(@RequestParam("id") Long id);
```

### 7.2 å®ç°å±‚æœ€ä½³å®è·µ

#### ğŸ”¹ æ•°æ®æƒé™æ§åˆ¶
```java
@Override
public CommonResult<List<AdminUserRespDTO>> getUserList(Collection<Long> ids) {
    return DataPermissionUtils.executeIgnore(() -> { // ç¦ç”¨æ•°æ®æƒé™
        List<AdminUserDO> users = userService.getUserList(ids);
        return success(BeanUtils.toBean(users, AdminUserRespDTO.class));
    });
}
```

#### ğŸ”¹ å¯¹è±¡è½¬æ¢è§„èŒƒ
```java
// ä½¿ç”¨MapStructè¿›è¡Œå¯¹è±¡è½¬æ¢ï¼Œé¿å…æ‰‹åŠ¨æ˜ å°„
AdminUserDO user = userService.getUser(id);
return success(BeanUtils.toBean(user, AdminUserRespDTO.class));
```

#### ğŸ”¹ å¼‚å¸¸å¤„ç†
```java
@Override
public CommonResult<Boolean> validateUserList(Collection<Long> ids) {
    try {
        userService.validateUserList(ids);
        return success(true);
    } catch (ServiceException ex) {
        return CommonResult.error(ex.getCode(), ex.getMessage());
    }
}
```

### 7.3 é…ç½®ç®¡ç†æœ€ä½³å®è·µ

#### ğŸ”¹ æœåŠ¡é…ç½®éš”ç¦»
```yaml
# system-serverç‹¬ç«‹é…ç½®
yudao:
  info:
    version: 1.0.0
    base-package: cn.iocoder.yudao.module.system
  swagger:
    title: ç³»ç»Ÿç®¡ç†æ¨¡å—
    description: æä¾›ç”¨æˆ·ã€è§’è‰²ã€æƒé™ç­‰ç³»ç»Ÿç®¡ç†åŠŸèƒ½
```

#### ğŸ”¹ å¤šç¯å¢ƒé…ç½®
```yaml
spring:
  profiles:
    active: local
  config:
    import:
      - optional:classpath:application-${spring.profiles.active}.yaml
      - optional:nacos:${spring.application.name}-${spring.profiles.active}.yaml
```

## 8. è®¾è®¡æ¨¡å¼åˆ†æ

### 8.1 æ¥å£éš”ç¦»åŸåˆ™ (ISP)
- æ¯ä¸ªAPIæ¥å£èŒè´£å•ä¸€ï¼Œåªæš´éœ²å¿…è¦çš„æ–¹æ³•
- å®¢æˆ·ç«¯åªä¾èµ–å®ƒéœ€è¦çš„æ¥å£ï¼Œä¸ä¾èµ–ä¸éœ€è¦çš„æ¥å£

### 8.2 ä¾èµ–å€’ç½®åŸåˆ™ (DIP)
- é«˜å±‚æ¨¡å—ï¼ˆè°ƒç”¨æ–¹ï¼‰ä¾èµ–æŠ½è±¡ï¼ˆAPIæ¥å£ï¼‰
- ä½å±‚æ¨¡å—ï¼ˆå®ç°æ–¹ï¼‰å®ç°æŠ½è±¡ï¼Œå…·ä½“ä¾èµ–æŠ½è±¡

### 8.3 å¤–è§‚æ¨¡å¼ (Facade)
- APIæ¨¡å—ä¸ºå¤æ‚çš„ä¸šåŠ¡é€»è¾‘æä¾›ç®€åŒ–çš„æ¥å£
- éšè—å†…éƒ¨å®ç°çš„å¤æ‚æ€§

### 8.4 é€‚é…å™¨æ¨¡å¼ (Adapter)
- APIå®ç°ç±»ä½œä¸ºé€‚é…å™¨ï¼Œå°†å†…éƒ¨æœåŠ¡é€‚é…ä¸ºå¤–éƒ¨æ¥å£
- å®ç°ä¸åŒæ•°æ®æ ¼å¼ä¹‹é—´çš„è½¬æ¢

### 8.5 æ¶æ„å¯¹æ¯”åˆ†æ

#### ä¼ ç»Ÿå•ä½“æ¶æ„ vs API/Serveråˆ†ç¦»æ¶æ„

| å¯¹æ¯”ç»´åº¦ | ä¼ ç»Ÿå•ä½“æ¶æ„ | API/Serveråˆ†ç¦»æ¶æ„ |
|----------|-------------|-------------------|
| **æ¨¡å—è€¦åˆåº¦** | é«˜è€¦åˆï¼Œæ¨¡å—é—´ç›´æ¥ä¾èµ– | ä½è€¦åˆï¼Œé€šè¿‡æ¥å£ä¾èµ– |
| **æœåŠ¡æ‹†åˆ†** | éš¾ä»¥æ‹†åˆ†ï¼Œç‰µä¸€å‘åŠ¨å…¨èº« | æ˜“äºæ‹†åˆ†ï¼Œæ¥å£å¥‘çº¦æ¸…æ™° |
| **å›¢é˜Ÿåä½œ** | ä¸²è¡Œå¼€å‘ï¼Œå®¹æ˜“å†²çª | å¹¶è¡Œå¼€å‘ï¼Œå‡å°‘å†²çª |
| **ç‰ˆæœ¬ç®¡ç†** | æ•´ä½“å‘å¸ƒï¼Œé£é™©è¾ƒå¤§ | ç‹¬ç«‹å‘å¸ƒï¼Œé£é™©å¯æ§ |
| **æµ‹è¯•å¤æ‚åº¦** | é›†æˆæµ‹è¯•å¤æ‚ | å•å…ƒæµ‹è¯•ç®€å•ï¼Œæ¥å£æµ‹è¯•æ¸…æ™° |
| **éƒ¨ç½²æ–¹å¼** | æ•´ä½“éƒ¨ç½² | ç‹¬ç«‹éƒ¨ç½²ï¼Œæ”¯æŒç°åº¦å‘å¸ƒ |

#### æ€§èƒ½ä¼˜åŠ¿åˆ†æ
```java
// APIæ¨¡å—è½»é‡çº§ï¼Œå¯åŠ¨å¿«é€Ÿ
// åªåŒ…å«æ¥å£å®šä¹‰å’ŒDTOï¼Œæ— ä¸šåŠ¡é€»è¾‘
public interface AdminUserApi {
    // æ¥å£å®šä¹‰ï¼Œæ— å®ç°ä»£ç 
}

// Serveræ¨¡å—åŠŸèƒ½å®Œæ•´ï¼Œä½†å¯ç‹¬ç«‹æ‰©å±•
@RestController
public class AdminUserApiImpl implements AdminUserApi {
    // å®Œæ•´çš„ä¸šåŠ¡å®ç°
    // å¯ç‹¬ç«‹éƒ¨ç½²å¤šä¸ªå®ä¾‹å®ç°è´Ÿè½½å‡è¡¡
}
```

## 9. æ€»ç»“

### 9.1 æ¶æ„ä¼˜åŠ¿

#### ğŸ¯ å¼€å‘æ•ˆç‡
- **å¹¶è¡Œå¼€å‘**ï¼šAPIå®šä¹‰åï¼Œå¤šå›¢é˜Ÿå¯å¹¶è¡Œå¼€å‘
- **æ¥å£å¤ç”¨**ï¼šAPIæ¨¡å—å¯è¢«å¤šä¸ªæœåŠ¡å¤ç”¨
- **å¿«é€Ÿé›†æˆ**ï¼šæ ‡å‡†åŒ–çš„æ¥å£ä¾¿äºå¿«é€Ÿé›†æˆ

#### ğŸ¯ ç³»ç»Ÿå¯ç»´æŠ¤æ€§
- **èŒè´£æ¸…æ™°**ï¼šæ¯ä¸ªæ¨¡å—èŒè´£æ˜ç¡®ï¼Œä¾¿äºç»´æŠ¤
- **ç‰ˆæœ¬æ§åˆ¶**ï¼šAPIç‰ˆæœ¬ç‹¬ç«‹ç®¡ç†ï¼Œå‡çº§æ›´å®‰å…¨
- **æ•…éšœéš”ç¦»**ï¼šæœåŠ¡é—´æ¾è€¦åˆï¼Œæ•…éšœå½±å“èŒƒå›´å°

#### ğŸ¯ å¾®æœåŠ¡æ¶æ„æ”¯æŒ
- **æœåŠ¡æ‹†åˆ†**ï¼šæ”¯æŒæŒ‰ä¸šåŠ¡åŸŸæ‹†åˆ†å¾®æœåŠ¡
- **ç‹¬ç«‹éƒ¨ç½²**ï¼šæ¯ä¸ªæœåŠ¡å¯ç‹¬ç«‹éƒ¨ç½²å’Œæ‰©å±•
- **æŠ€æœ¯æ ˆçµæ´»**ï¼šä¸åŒæœåŠ¡å¯é€‰æ‹©ä¸åŒæŠ€æœ¯æ ˆ

### 9.2 é€‚ç”¨åœºæ™¯

è¿™ç§API/Serveråˆ†ç¦»æ¶æ„ç‰¹åˆ«é€‚åˆï¼š

1. **ä¼ä¸šçº§åº”ç”¨**ï¼šéœ€è¦é«˜å¯ç»´æŠ¤æ€§å’Œæ‰©å±•æ€§
2. **SaaSå¹³å°**ï¼šéœ€è¦æ”¯æŒå¤šç§Ÿæˆ·å’Œé«˜å¹¶å‘
3. **å¾®æœåŠ¡æ¶æ„**ï¼šéœ€è¦æœåŠ¡é—´è§£è€¦å’Œç‹¬ç«‹éƒ¨ç½²
4. **å›¢é˜Ÿåä½œ**ï¼šå¤šå›¢é˜Ÿå¹¶è¡Œå¼€å‘çš„å¤§å‹é¡¹ç›®

### 9.3 æŠ€æœ¯è¦ç‚¹æ€»ç»“

#### ğŸ”§ å…³é”®æŠ€æœ¯ç»„ä»¶
- **Spring Cloud OpenFeign**ï¼šæœåŠ¡é—´è°ƒç”¨
- **Spring Cloud Gateway**ï¼šAPIç½‘å…³è·¯ç”±
- **Nacos**ï¼šæœåŠ¡æ³¨å†Œä¸å‘ç°ã€é…ç½®ç®¡ç†
- **MyBatis Plus**ï¼šæ•°æ®è®¿é—®å±‚å¢å¼º
- **Spring Security**ï¼šå®‰å…¨è®¤è¯æ¡†æ¶

#### ğŸ”§ æ ¸å¿ƒè®¾è®¡ç†å¿µ
- **å¥‘çº¦ä¼˜å…ˆ**ï¼šAPIæ¥å£ä½œä¸ºæœåŠ¡å¥‘çº¦
- **èŒè´£åˆ†ç¦»**ï¼šæ¥å£å®šä¹‰ä¸å®ç°åˆ†ç¦»
- **ä¾èµ–ç®¡ç†**ï¼šæ¸…æ™°çš„æ¨¡å—ä¾èµ–å…³ç³»
- **æ ‡å‡†åŒ–**ï¼šç»Ÿä¸€çš„ç¼–ç è§„èŒƒå’Œæœ€ä½³å®è·µ

### 9.4 å­¦ä¹ å»ºè®®

#### ğŸ“š å­¦ä¹ è·¯å¾„
1. **ç†è§£è®¾è®¡æ€æƒ³**ï¼šå…ˆç†è§£ä¸ºä»€ä¹ˆè¦è¿™æ ·è®¾è®¡
2. **åˆ†æä¾èµ–å…³ç³»**ï¼šç†è§£æ¨¡å—é—´çš„ä¾èµ–å…³ç³»
3. **å®è·µä»£ç ç¼–å†™**ï¼šæŒ‰ç…§è§„èŒƒç¼–å†™APIå’Œå®ç°
4. **æŒæ¡é…ç½®ç®¡ç†**ï¼šå­¦ä¼šé…ç½®Feignã€Nacosç­‰ç»„ä»¶
5. **æ·±å…¥æ¡†æ¶åŸç†**ï¼šç†è§£Spring Cloudçš„å·¥ä½œæœºåˆ¶

#### ğŸ“š å®è·µå»ºè®®
1. **ä»ç®€å•æ¨¡å—å¼€å§‹**ï¼šå…ˆå­¦ä¹ systemæ¨¡å—çš„åŸºç¡€åŠŸèƒ½
2. **å…³æ³¨æ¥å£è®¾è®¡**ï¼šé‡ç‚¹å­¦ä¹ APIæ¥å£çš„è®¾è®¡è§„èŒƒ
3. **ç†è§£æ•°æ®æµè½¬**ï¼šè·Ÿè¸ªæ•°æ®åœ¨å„å±‚ä¹‹é—´çš„æµè½¬è¿‡ç¨‹
4. **æŒæ¡è°ƒè¯•æŠ€å·§**ï¼šå­¦ä¼šè°ƒè¯•å¾®æœåŠ¡é—´çš„è°ƒç”¨é—®é¢˜

### 9.5 æ‰©å±•æ€è€ƒ

#### ğŸ¤” æ¶æ„æ¼”è¿›æ–¹å‘
- **æœåŠ¡ç½‘æ ¼**ï¼šè€ƒè™‘å¼•å…¥Istioç­‰æœåŠ¡ç½‘æ ¼æŠ€æœ¯
- **äº‹ä»¶é©±åŠ¨**ï¼šå¼•å…¥äº‹ä»¶é©±åŠ¨æ¶æ„æ¨¡å¼
- **é¢†åŸŸé©±åŠ¨**ï¼šç»“åˆDDDè¿›è¡Œæ›´ç»†ç²’åº¦çš„æœåŠ¡æ‹†åˆ†
- **äº‘åŸç”Ÿ**ï¼šå‘Kubernetesç­‰äº‘åŸç”Ÿå¹³å°è¿ç§»

è¿™ç§åˆ†å±‚æ¶æ„æ˜¯ç°ä»£å¾®æœåŠ¡æ¶æ„çš„**æœ€ä½³å®è·µä¹‹ä¸€**ï¼Œä¸ä»…é€‚ç”¨äºèŠ‹é“äº‘é¡¹ç›®ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºå…¶ä»–å¾®æœåŠ¡é¡¹ç›®çš„æ¶æ„å‚è€ƒã€‚

---

*æœ¬æ–‡æ¡£åŸºäºèŠ‹é“äº‘é¡¹ç›® yudao-cloud-mini master-jdk17 åˆ†æ”¯åˆ†ææ•´ç†*
*æ–‡æ¡£ç‰ˆæœ¬ï¼šv1.0*
*æ›´æ–°æ—¶é—´ï¼š2025-08-14*
